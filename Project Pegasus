-- Pegasus Project - Arise Crossover Enhanced
local scriptEnabled = false
local firstActivation = true

-- رابط السكربت الأساسي (الجزء الذي طلبته)
local function LoadOriginalScript()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/JustLevel/goombahub/main/AriseCrossover.lua", true))()
end

-- إصلاح Winter Raid المتقدم
local function FixWinterRaid()
    while task.wait(1) do
        if scriptEnabled and game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("WinterRaidGUI") then
            local character = game.Players.LocalPlayer.Character
            if character and character:FindFirstChild("Humanoid") then
                local Humanoid = character.Humanoid
                
                -- تحسينات السرعة والانتقال
                Humanoid:SetAttribute("NPCTransitionBoost", 3.5) -- زيادة سرعة الانتقال
                Humanoid:SetAttribute("MoveDelay", 0.15) -- تقليل وقت التأخير
                
                -- حل مشكلة التوقف
                if Humanoid.MoveDirection.Magnitude > 0 and Humanoid:GetState() == Enum.HumanoidStateType.Running then
                    Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                    task.wait(0.08)
                    Humanoid:ChangeState(Enum.HumanoidStateType.Running)
                end
            end
        end
    end
end

-- واجهة التفعيل الأولى
local function CreateActivationPanel()
    local activationUI = Instance.new("ScreenGui")
    activationUI.Name = "PegasusLoader"
    activationUI.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 300, 0, 180)
    mainFrame.Position = UDim2.new(0.5, -150, 0.5, -90)
    mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    mainFrame.BorderColor3 = Color3.fromRGB(0, 162, 255)
    mainFrame.Parent = activationUI

    local activateBtn = Instance.new("TextButton")
    activateBtn.Text = "تفعيل Pegasus"
    activateBtn.Size = UDim2.new(0, 180, 0, 45)
    activateBtn.Position = UDim2.new(0.5, -90, 0.5, -22.5)
    activateBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 80)
    activateBtn.Font = Enum.Font.GothamBold
    activateBtn.TextColor3 = Color3.new(1, 1, 1)
    activateBtn.TextSize = 16
    activateBtn.Parent = mainFrame

    activateBtn.MouseButton1Click:Connect(function()
        scriptEnabled = true
        firstActivation = false
        activationUI:Destroy()
        RunEnhancedScript()
    end)
end

-- الدالة الرئيسية لتشغيل السكربت
local function RunEnhancedScript()
    -- 1. تحميل السكربت الأساسي من الرابط المطلوب
    LoadOriginalScript()
    
    -- 2. تفعيل إصلاح Winter Raid
    coroutine.wrap(FixWinterRaid)()
    
    -- 3. إعداد إعادة التشغيل التلقائي
    game:GetService("Players").LocalPlayer.CharacterAdded:Connect(function()
        task.wait(2)
        if scriptEnabled then
            RunEnhancedScript()
        end
    end)
    
    -- 4. رسالة التأكيد
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Pegasus Project",
        Text = "تم التفعيل بنجاح | WinterRaid Fix Active",
        Duration = 5
    })
end

-- بدء التشغيل
if firstActivation then
    CreateActivationPanel()
elseif scriptEnabled then
    RunEnhancedScript()
end
