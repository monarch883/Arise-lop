-- سكربت Arise Crossover مع إصلاحات نهائية
local scriptEnabled = false
local firstActivation = true

local function ShowActivationMessage()
    local gui = Instance.new("ScreenGui")
    gui.Name = "PegasusActivationMsg"
    gui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 400, 0, 120)
    frame.Position = UDim2.new(0.5, -200, 0.8, -60)
    frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    frame.BorderColor3 = Color3.fromRGB(0, 162, 255)
    frame.Parent = gui

    local title = Instance.new("TextLabel")
    title.Text = "PEGASUS PROJECT"
    title.Font = Enum.Font.GothamBlack
    title.TextSize = 24
    title.TextColor3 = Color3.fromRGB(0, 162, 255)
    title.Size = UDim2.new(1, 0, 0, 40)
    title.Position = UDim2.new(0, 0, 0, 10)
    title.BackgroundTransparency = 1
    title.Parent = frame

    local message = Instance.new("TextLabel")
    message.Text = "✓ تم التفعيل بنجاح | Winter Raid Fix Active"
    message.Font = Enum.Font.GothamBold
    message.TextSize = 18
    message.TextColor3 = Color3.new(1, 1, 1)
    message.Size = UDim2.new(1, 0, 0, 40)
    message.Position = UDim2.new(0, 0, 0, 50)
    message.BackgroundTransparency = 1
    message.Parent = frame

    delay(5, function() gui:Destroy() end)
end

-- ... (بقية دوال التفعيل والإصلاحات كما في الكود السابق)

local function FixWinterRaid()
    while wait(1) do
        if scriptEnabled and game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("WinterRaidGUI") then
            -- إصلاح متقدم للانتقال بين NPCs
            local Humanoid = game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
            if Humanoid then
                -- تقليل وقت الانتقال بشكل أكثر فعالية
                Humanoid:SetAttribute("NPC_Transition_Speed", 0.3)
                
                -- حل جذري لمشكلة التوقف
                if Humanoid.MoveDirection.Magnitude > 0 and Humanoid:GetState() == Enum.HumanoidStateType.Running then
                    Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                    wait(0.1)
                    Humanoid:ChangeState(Enum.HumanoidStateType.Running)
                end
            end
        end
    end
end
